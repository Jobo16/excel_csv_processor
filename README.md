# Excel CSV 处理器

一个用于批量处理Excel文件的Python工具，能够将Excel文件转换为CSV格式并合并指定列到题目信息列。

## 功能特性

- 📊 **Excel转CSV转换**：自动处理合并单元格，保持数据完整性
- 🔄 **智能列合并**：将多个相关列合并为结构化的题目信息
- 📁 **批量处理**：一次性处理整个文件夹中的所有Excel文件
- 🛡️ **错误处理**：完善的异常处理和进度提示
- 🎯 **相对路径**：使用相对路径，便于项目迁移和部署

## 项目结构

```
新建文件夹/
├── excel_csv_processor.py    # 主程序文件
├── input/                    # 输入文件夹（放置Excel文件）
├── output/                   # 输出文件夹（生成的CSV文件）
└── README.md                # 项目说明文档
```

## 安装依赖

确保已安装以下Python包：

```bash
pip install pandas openpyxl
```

## 使用方法

### 1. 准备文件

将需要处理的Excel文件（`.xlsx`格式）放入 `input` 文件夹中。

### 2. 运行程序

```bash
python excel_csv_processor.py
```

### 3. 查看结果

处理完成后，在 `output` 文件夹中查看生成的CSV文件。

## 处理流程

1. **Excel转CSV**：
   - 读取Excel文件的第一个工作表
   - 处理合并单元格，确保数据完整性
   - 特殊处理"答题说明"列的空白单元格填充
   - 生成UTF-8 BOM编码的CSV文件

2. **列合并处理**：
   - 检查必要列：`材料内容`、`*题目类型`、`*题干`、`*正确答案`
   - 合并选项列（选项A到选项K）
   - 生成结构化的"题目信息"列
   - 输出最终的处理结果

## 支持的列格式

### 必需列
- `材料内容`：题目的材料内容
- `*题目类型`：题目类型说明
- `*题干`：题目问题描述
- `*正确答案`：标准答案

### 可选列
- `答题说明`：答题相关说明
- `选项A` 到 `选项K`：多选题的选项内容

## 输出格式

生成的CSV文件包含原有的所有列，并新增一个"题目信息"列，格式如下：

```
材料内容：
[材料内容文本]

答题说明：
[答题说明文本]

题目类型：
[题目类型文本]

题干：
[题干文本]

正确答案：
[正确答案文本]

选项：
A. [选项A内容]
B. [选项B内容]
...
```

## 错误处理

- 自动检查输入目录是否存在
- 验证必需列是否完整
- 处理文件读写异常
- 提供详细的错误信息和处理进度

## 注意事项

1. **文件格式**：仅支持`.xlsx`格式的Excel文件
2. **编码格式**：输出的CSV文件使用UTF-8 BOM编码
3. **文件命名**：输出文件名格式为`原文件名_processed.csv`
4. **目录权限**：确保程序对input和output目录有读写权限

## 示例

假设input文件夹中有文件`1XT960310.xlsx`，运行程序后会在output文件夹中生成`1XT960310_processed.csv`。

## 技术实现

- **语言**：Python 3.x
- **主要依赖**：
  - `pandas`：数据处理和CSV操作
  - `openpyxl`：Excel文件读取和合并单元格处理
  - `pathlib`：现代化的路径操作

## 版本信息

- **版本**：1.0.0
- **作者**：AI Assistant
- **更新日期**：2024

## 许可证

本项目仅供学习和内部使用。